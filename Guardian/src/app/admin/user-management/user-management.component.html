<div class="container mt-1">
    <div class="row">
      <div class="col-12 d-flex justify-content-between align-items-center">
        <h5 class="my-3">Gestión de Usuarios</h5>
      </div>
    </div>
    <div class="row">
        <div class="hamburger-menu" (click)="toggleSearchPanel()">
            <div></div>
            <div></div>
            <div></div>
        </div>
        <div class="col-md-4 search-panel" [class.hidden]="isSearchPanelHidden">
            <div class="card">
            <div class="card-body">
                <h6 class="card-title">Buscar Usuarios</h6>
                <div class="input-group mb-3">
                <input type="text" class="form-control" placeholder="Escribe el nombre aqui..." (input)="searchUsers($event)">
                
                </div>
                <ul class="list-group mt-3">
                <li *ngFor="let user of userList" class="list-group-item list-group-item-action" (click)="selectUser(user.userId)">
                    {{ user.firstName + ' ' + user.lastName }}
                </li>
                </ul>
            </div>
            </div>
        </div>
        <div class="col-md-8">
            <div class="card">
                <div class="card-body">
                    <h6 class="card-title">Detalles del Usuario</h6>
                    <div class="user-edit-container">
                        <form [formGroup]="userForm" (ngSubmit)="saveUser()">
                            <div class="form-group col-md-12 d-flex">
                                <div class="col-md-8 mb-2 pr-2">
                                    <label for="userName">Nombre de Usuario</label>
                                    <input id="userName" class="form-control" formControlName="userName" placeholder="Nombre de usuario">
                                    <div *ngIf="userForm.get('userName')?.invalid && userForm.get('userName')?.touched" class="invalid-feedback">
                                        Nombre de usuario es obligatorio.
                                    </div>
                                </div>
                                <div class="col-md-4 d-flex align-items-end pl-2 mx-2 mb-3">
                                    <input class="form-check-input form-check-input-lg" formControlName="isEnabled" type="checkbox"> Habilitado
                                   
                                </div>
                            </div>
                            <div class="form-group mb-2">
                                <label for="firstName">Nombre</label>
                                <input id="firstName" class="form-control" formControlName="firstName" placeholder="Nombre">
                                <div *ngIf="userForm.get('firstName')?.invalid && userForm.get('firstName')?.touched" class="invalid-feedback">
                                    Nombre es obligatorio.
                                </div>
                            </div>    
                            <div class="form-group mb-2">
                                <label for="lastName">Apellido</label>
                                <input id="lastName" class="form-control" formControlName="lastName" placeholder="Apellido">
                                <div *ngIf="userForm.get('lastName')?.invalid && userForm.get('lastName')?.touched" class="invalid-feedback">
                                    Apellido es obligatorio.
                                </div>
                            </div>    
                            <div class="form-group mb-2">
                                <label for="companyId">Empresa</label>
                                <select id="companyId" formControlName="companyId" class="form-select">
                                    <option *ngFor="let company of companies" [value]="company.companyId">
                                        {{ company.name }}
                                      </option>
                                </select>
                                <div *ngIf="userForm.get('companyId')?.invalid && userForm.get('companyId')?.touched" class="invalid-feedback">
                                    Compañia es obligatorio.
                                </div>
                            </div>    
                            <div class="form-group mb-2">
                                <label for="groupId">Grupo</label>
                                <select id="groupId" formControlName="groupId" class="form-select">
                                    <option *ngFor="let group of groups" [value]="group.groupId">
                                        {{ group.name }}
                                      </option>
                                </select>
                                <div *ngIf="userForm.get('groupId')?.invalid && userForm.get('groupId')?.touched" class="invalid-feedback">
                                    Grupo es obligatorio.
                                </div>
                            </div>    
                            <div class="form-group mb-2">
                                <span placeholder="Ultimo Acceso" >
                                    <strong>Último acceso:</strong> {{userForm.get('lastAccess4UI')?.value}}
                                </span>
                            </div>    
                            <div class="form-group mb-2">
                                <span placeholder="Estatus" >
                                    <strong>Estatus:</strong> {{userForm.get('statusIdStr')?.value}}
                                </span>
                            </div>
                            <div class="form-group mb-2">
                                <span>
                                    Creado: {{userForm.get('creationDateUI')?.value}}
                                    &nbsp;>&nbsp;
                                    Creado por: {{userForm.get('createdByUserName')?.value}}
                                </span>
                            </div>
                            <div class="form-group mb-2">
                                <span>
                                    Actualizado por: {{userForm.get('lastUpdatedByUserName')?.value}}
                                </span>
                            </div>
                            <div class="d-flex justify-content-end my-3">
                                <button type="button" class="btn btn-primary mx-2 btn-floating-secondary" (click)="newUser()">Nuevo</button>
                                <button type="submit" class="btn btn-success btn-floating">Guardar Usuario</button>
                            </div>    
                        </form>

                        <form [formGroup]="passwordForm" (ngSubmit)="setPassword()">
                            <div class="form-group mb-2">
                                <input formControlName="password" type="password" class="form-control mb-2 w-50" placeholder="Password">
                                <div *ngIf="passwordForm.get('password')?.invalid && passwordForm.get('password')?.touched" class="invalid-feedback">
                                    {{this.passwordErrorMsg}}
                                </div>
                                <button type="submit">Actualiza Password</button>
                            </div>    
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>